---
layout:     post
title:      jvm原理
subtitle:    jvm
date:       2020-12-01
author:     XT
header-img: img/post-bg-coffee.jpeg
catalog: 	 true
tags:
    - 面试
---


> jvm原理


----

# 一、jvm


## jvm是什么

JVM是Java Virtual Machine的缩写，JVM是一种用于计算设备的规范，它是一个虚构出来的计算机，是通过在实际的计算机上仿真模拟各种计算机功能来实现的。

# 二、Java 内存区域

![img](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91c2VyLWdvbGQtY2RuLnhpdHUuaW8vMjAxNy85LzQvZGQzYjE1YjNkODgyNmZhZWFlMjA2Mzk3NmZiOTkyMTM_aW1hZ2VWaWV3Mi8wL3cvMTI4MC9oLzk2MC9mb3JtYXQvd2VicC9pZ25vcmUtZXJyb3IvMQ)

## 1、程序计数器

看作当前现成的行号指示器,线程私有,内存较小,如果线程正在执行一个 Java 方法，这个计数器记录的是正在执行的虚拟机字节码指令的地址；如果正在执行的是 Native 方法，这个计数器的值则为 (Undefined)。此内存区域是唯一一个在 Java 虚拟机规范中没有规定任何 OutOfMemoryError 情况的区域。

## 2、 Java 虚拟机栈

线程私有，生命周期和线程一致。描述的是 Java 方法执行的内存模型,每个方法在执行时都会创建一个栈帧(Stack Frame)用于存储局部变量表`、`操作数栈`、`动态链接`、`方法出口等信息。每一个方法从调用直至执行结束，就对应着一个栈帧从虚拟机栈中入栈到出栈的过程。

局部变量表：存放了编译期可知的各种基本类型(boolean、byte、char、short、int、float、long、double)、对象引用(reference 类型)和 returnAddress 类型(指向了一条字节码指令的地址)

StackOverflowError：线程请求的栈深度大于虚拟机所允许的深度。
OutOfMemoryError：如果虚拟机栈可以动态扩展，而扩展时无法申请到足够的内存。

## 3、本地方法栈

本地方法栈则为虚拟机使用到的 Native 方法服务。也会有 StackOverflowError 和 OutOfMemoryError 异常。hotspot直接把2和3合并了.

## 4、java 堆

java堆事所有线程共享的一块区域,存放对象的实例.所有对象都在这里分配内存,java堆事垃圾收集管理的区域,所以也被称为GC堆,OutOfMemoryError：如果堆中没有内存完成实例分配，并且堆也无法再扩展时，抛出该异常。

## 5、方法区

各个线程共享的区域,存储被虚拟机加载的类信息,常量,静态变量,即时编译器编译后的代码等数据.也称非堆.

## 6、运行时常量池

是方法区的一部分,用于存放编译期生成的各种字面量和符号引用。编译器和运行期(String 的 intern() )都可以将常量放入池中。内存有限，无法申请时抛出 OutOfMemoryError。

## 7、直接内存

非虚拟机的数据区部分,它可以使用 Native 函数库直接分配堆外内存，然后通过一个存储在 Java 堆中的 DirectByteBuffer 对象作为这块内存的引用进行操作。可以避免在 Java 堆和 Native 堆中来回的数据耗时操作。
OutOfMemoryError：会受到本机内存限制，如果内存区域总和大于物理内存限制从而导致动态扩展时出现该异常。

# 三、对象的创建过程

## 1、对象的创建

## 2、对象的内存分布

## 3、对象的访问定位





